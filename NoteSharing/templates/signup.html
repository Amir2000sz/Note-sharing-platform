{% extends "base.html" %}
{% block title %}Sign Up{% endblock %}

{% block content %}
<section class="flex flex-1 items-center justify-center px-4 py-12">
    <div class="w-full max-w-3xl rounded-2xl bg-white/80 p-10 shadow-xl backdrop-blur-sm">
        <h2 class="text-center text-3xl font-semibold text-[#3b2f2f]">Create your account</h2>
        <p class="mt-2 text-center text-sm text-[#5e4634]">
            Already have an account?
            <a href="{% url 'login' %}" class="font-medium text-[#c17f59] hover:text-[#a96844]">Sign in</a>
        </p>
        {% if userForm.non_field_errors or profileForm.non_field_errors %}
            <div class="mt-6 rounded-lg border border-red-200 bg-red-50 px-4 py-3 text-sm text-red-700">
                {% for error in userForm.non_field_errors %}
                    <p>{{ error }}</p>
                {% endfor %}
                {% for error in profileForm.non_field_errors %}
                    <p>{{ error }}</p>
                {% endfor %}
            </div>
        {% endif %}
        <form method="POST" enctype="multipart/form-data" class="mt-8 space-y-6">
            {% csrf_token %}
            <div class="grid gap-6 md:grid-cols-2">
                <div class="md:col-span-2">
                    <label for="{{ userForm.username.id_for_label }}" class="mb-1 block text-sm font-medium text-[#3b2f2f]">
                        {{ userForm.username.label }}
                    </label>
                                        {{ userForm.username }}
                    {% if userForm.username.errors %}
                        <p class="mt-1 text-sm text-red-600">{{ userForm.username.errors.0 }}</p>
                    {% endif %}
                </div>
                <div>
                    <label for="{{ userForm.password1.id_for_label }}" class="mb-1 block text-sm font-medium text-[#3b2f2f]">
                        {{ userForm.password1.label }}
                    </label>
                    <div class="relative">
                        {{ userForm.password1 }}
                        <button
                            type="button"
                            class="toggle-password absolute inset-y-0 right-3 flex items-center text-[#a96844] transition hover:text-[#7a4d32]"
                            data-target="{{ userForm.password1.id_for_label }}"
                            aria-label="Toggle password visibility"
                        >
                            <svg class="eye-open h-5 w-5" fill="none" stroke="currentColor" stroke-width="1.5" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M2.25 12c1.5-4 5.25-7.5 9.75-7.5S20.25 8 21.75 12c-1.5 4-5.25 7.5-9.75 7.5S3.75 16 2.25 12z" />
                                <path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
                            </svg>
                            <svg class="eye-closed hidden h-5 w-5" fill="none" stroke="currentColor" stroke-width="1.5" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M3.98 8.223A10.477 10.477 0 012.25 12c1.5 4 5.25-7.5 9.75-7.5S20.25 8 21.75 12c-1.5 4-5.25 7.5-9.75 7.5S3.75 16 2.25 12z" />
                                <path stroke-linecap="round" stroke-linejoin="round" d="M6.228 6.228L3 3m3.228 3.228L9.75 9.75m4.5 4.5L21 21m-6.75-6.75a3 3 0 01-4.5-4.5" />
                            </svg>
                        </button>
                    </div>
                    {% if userForm.password1.errors %}
                        <p class="mt-1 text-sm text-red-600">{{ userForm.password1.errors.0 }}</p>
                    {% endif %}
                </div>
                <div>
                    <label for="{{ userForm.password2.id_for_label }}" class="mb-1 block text-sm font-medium text-[#3b2f2f]">
                        {{ userForm.password2.label }}
                    </label>
                    <div class="relative">
                        {{ userForm.password2 }}
                        <button
                            type="button"
                            class="toggle-password absolute inset-y-0 right-3 flex items-center text-[#a96844] transition hover:text-[#7a4d32]"
                            data-target="{{ userForm.password2.id_for_label }}"
                            aria-label="Toggle password visibility"
                        >
                            <svg class="eye-open h-5 w-5" fill="none" stroke="currentColor" stroke-width="1.5" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M2.25 12c1.5-4 5.25-7.5 9.75-7.5S20.25 8 21.75 12c-1.5 4-5.25 7.5-9.75 7.5S3.75 16 2.25 12z" />
                                <path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
                            </svg>
                            <svg class="eye-closed hidden h-5 w-5" fill="none" stroke="currentColor" stroke-width="1.5" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M3.98 8.223A10.477 10.477 0 012.25 12c1.5 4 5.25-7.5 9.75-7.5S20.25 8 21.75 12c-1.5 4-5.25 7.5-9.75 7.5S3.75 16 2.25 12z" />
                                <path stroke-linecap="round" stroke-linejoin="round" d="M6.228 6.228L3 3m3.228 3.228L9.75 9.75m4.5 4.5L21 21m-6.75-6.75a3 3 0 01-4.5-4.5" />
                            </svg>
                        </button>
                    </div>
                    {% if userForm.password2.errors %}
                        <p class="mt-1 text-sm text-red-600">{{ userForm.password2.errors.0 }}</p>
                    {% endif %}
                </div>
                {% for field in profileForm %}
                    <div class="{% if field.name == 'bio' or field.name == 'ProfileImage' %}md:col-span-2{% endif %}">
                        <label for="{{ field.id_for_label }}" class="mb-1 block text-sm font-medium text-[#3b2f2f]">
                            {{ field.label }}
                        </label>
                        {{ field }}
                        {% if field.help_text %}
                            <p class="mt-1 text-xs text-[#5e4634]">{{ field.help_text }}</p>
                        {% endif %}
                        {% if field.errors %}
                            <p class="mt-1 text-sm text-red-600">{{ field.errors.0 }}</p>
                        {% endif %}
                    </div>
                {% endfor %}
            </div>
            <button
                type="submit"
                class="w-full rounded-full bg-[#d2a679] py-3 font-semibold text-white transition hover:bg-[#c59568]"
            >
                Register
            </button>
        </form>
    </div>
</section>
<script>
document.addEventListener('DOMContentLoaded', function () {
    document.querySelectorAll('.toggle-password').forEach(function (toggleBtn) {
        toggleBtn.addEventListener('click', function () {
            const targetId = toggleBtn.getAttribute('data-target');
            const input = document.getElementById(targetId);
            if (!input) {
                return;
            }
            const isHidden = input.getAttribute('type') === 'password';
            input.setAttribute('type', isHidden ? 'text' : 'password');
            toggleBtn.querySelector('.eye-open').classList.toggle('hidden', !isHidden);
            toggleBtn.querySelector('.eye-closed').classList.toggle('hidden', isHidden);
        });
    });
});
</script>
{% endblock %}
